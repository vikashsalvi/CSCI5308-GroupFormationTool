<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Reset Password</title>
	<link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
		  integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" rel="stylesheet">
	<script crossorigin="anonymous"
			integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
			src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script crossorigin="anonymous"
			integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
			src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
	<script crossorigin="anonymous"
			integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
			src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

</head>
<body>
<div class="container-fluid">
	<div class="d-flex justify-content-center mt-5">
		<div class="card">
			<div class="card-header">
				Set new Password
			</div>
			<div class="card-body">
				<div class="alert alert-danger" role="alert" th:if="${error}">
					<strong>Please enter </strong> valid Password
				</div>
				<form action="/resetPassword" method="POST">

					<div class="form-group" th:if="${completed}">
						<div class="card">
							<div class="card-body">
								<div class="info" role="contentinfo">
									<strong>Password changed!!</strong>
									<br/>
									<a href="/login">Click here to login</a>
								</div>
							</div>
						</div>
					</div>
					<div class="form-group" th:if="${!completed}">
						<div th:if="${not error or password_error==null}">
							<div class="form-group">
								<label for="password">Password</label>
								<input class="form-control" id="password" name="password" placeholder="Password"
									   type="password">
							</div>
							<div class="form-group">
								<label for="cPassword">Confirm Password</label>
								<input class="form-control" id="cPassword" name="cPassword"
									   placeholder="Confirm Password"
									   type="password">
							</div>
						</div>
						<div th:if="${error and password_error!=null}">
							<div>
								<label for="password_error">Password</label>
								<input class="form-control is-invalid" id="password_error" name="password"
									   placeholder="Password"
									   type="password">
								<div class="invalid-feedback">
									<span th:text="${password_error}"></span>
								</div>
							</div>
							<div class="form-group">
								<label for="cPassword_error">Confirm Password</label>
								<input class="form-control is-invalid" id="cPassword_error" name="cPassword"
									   placeholder="Confirm Password"
									   type="password">
								<div class="invalid-feedback">
									<span th:text="${password_error}"></span>
								</div>
							</div>
						</div>

						<div th:if="${#httpServletRequest.getParameter('to') == null} ">
							<input class="form-control" name="token" 
								   th:value="${token}" type="hidden"></input>
						</div>
						<div th:if="${#httpServletRequest.getParameter('to') != null} ">
							<input class="form-control" name="token" 
								   th:value="${#httpServletRequest.getParameter('to')}" type="hidden"></input>
						</div>

						<button class="btn btn-primary" type="submit">Change password</button>
					</div>
				</form>
			</div>
		</div>
	</div>

</div>

<script crossorigin="anonymous"
		integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
		src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script crossorigin="anonymous"
		integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
		src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script crossorigin="anonymous"
		integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
</body>
</html>
